## Overview
```pre
├── check_dataset_files.py
├── check_file_dirs.py
├── inference_on_dir.py
├── README.md
└── test
    ├── configs
    │   ├── evaluate_config.yaml
    │   └── test_config.yaml
    ├── evaluate.py
    ├── inference_on_dir_new.py
    ├── parse_utility.py
    └── test_and_evaluate.py

```
### Validation of path and files
   1. check_dataset_files.py - to check if dataset contain all required to training(wavegrad, grad_tts) files: 
.txt, .npy, .wav, .TextGrid 
   2. check_file_dirs.py - different functions to validate paths, directories

### Inference on directory 
   1. inference_on_dir.py - inference of grad_tts(+ default hifigan), wavegrad(embeddings required to be precomputed)
   2. inference_on_dir_new.py - inference of grad_tts(+custom hifigan), wavegrad, voice_encoder, grad_tts(without hifigan) - used in test_and_evaluate.py script

### How to use test_and_evaluate.py 

`python test_and_evaluate.py --config <path_to_config> --mode <[test, evaluate, test_and_evaluate]> --save_intermediate <True>`

1. config - path to config file with following attributes:
   1) data - path to data, requires to be in following format:
      1. for test mode: can be single file, or list of files, or path to directory(dir/speakers/wavs_per_speaker)
      2. for test_and_evaluate mode: path to data in the defined format: data/speakers/ for each speaker two wave samples: 
         1) one with text
         2) one without text 
      3. for evaluate mode: val_data must be specified
   2) device
   3) wavegrad_ckpts, grad_tts_ckpts, hifi_gan(configs, ckpts), encoder_ckpts - paths to models to be tested
   4) output_path - path to dir with results
   5) output_text - text to be generated by wavegrad and grad_tts models(not passed during evalution)
   6) log_path(optional) - for evaluate mode only - file where metrics will be recorded 
   7) sampling_rate - for evaluate mode only
   8) val_data - dir/speaker/ wav file with ground truth audio and text
2. mode - can be one of the following options:
   1) test - in the output_path will be directories with wavs generated by tested models
   2) evaluate - prints metrics and can be recorded in log_path file
   3) test_and_evaluate - used when we don't specify val_data directory
3. save_intermediate - for test_and_evaluate/evaluate mode saves intermediate results like voice_embeddings
         
### /test/configs 
Examples of configs to be used for validation and testing
                                                                                   